---
description: >-
  Often the default random function in whatever language is not
  cryptographically secure, making it possible to predict values
---

# Random Number Generators

### Python `import random`

The default Python `random` module is very fast, but not very secure. If the application allows you to get 624 or more random values from it, you can crack the random seed used by the generator to predict future values. You can also use this to know values that are generated by the application, but not shown to you, like generating a key right after showing you 624 random values.&#x20;

Python has a handy library called [RandCrack](https://github.com/tna0y/Python-random-module-cracker) which can crack the seed of Python's `random` module. Just submit 624 values and then you can predict future values:&#x20;

```python
import random
from randcrack import RandCrack

rc = RandCrack()

# Fill RandCrack to get seed
for i in range(624):
	rc.submit(random.getrandbits(32))
	# Could be filled with random.randint(0,4294967294) or random.randrange(0,4294967294)

# Generate and predict 10 random values
predicted = [rc.predict_randrange(0, 1000) for _ in range(10)]
real = [random.randrange(0, 1000) for _ in range(10)]

print(f"Random result:  {predicted}")
print(f"Cracker result: {real}")
```

I made a writeup of a challenge where you had to crack the seed after 624 random values, to generate the same key as the application would to encrypt the flag:

{% embed url="https://jorianwoltjer.com/blog/post/ctf/google-beginners-quest-2021/5-twisted-robot" %}
A writeup where RandCrack is used to predict future values to get a key
{% endembed %}

## JavaScript `Math.random()`

Javascript has a few variants per browser. Chrome, Firefox and safari all do slightly different things when it comes to generating random numbers. But Chrome uses V8 for JavaScript, and so does NodeJS. This makes it the biggest target.&#x20;

The Math.random() function is not cryptographically secure, and with about 5 random numbers from it, one can crack the random state and predict future values.&#x20;

[PwnFunction ](https://www.youtube.com/watch?v=-h\_rj2-HP2E)made a great video explaining the attack and published a Python script that uses the Z3 solver to solve the random state and predict future numbers.&#x20;

{% embed url="https://github.com/PwnFunction/v8-randomness-predictor/blob/main/main.py" %}
Python script that can predict V8 Math.random() after 5 inputs
{% endembed %}

```javascript
> Array.from(Array(5), Math.random)
[
  0.8971227301319089,
  0.6209246336108811,
  0.5512987330965515,
  0.4297735084849734,
  0.9373384773813349
]
// Save to 'sequence' in the Python script and run it
> Math.random()
0.446420067790525
```
